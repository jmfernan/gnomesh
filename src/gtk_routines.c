#ifdef HAVE_CONFIG_H
#  include <config.h>
#endif

#include <gtk/gtk.h>

#include "gtk_routines.h"
#include "interface.h"
#include "support.h"
#include "main.h"


GdkGC *get_pen (GdkDrawable *pixmap, GdkColor *c)
{
  GdkGC *gc;
  gc= gdk_gc_new (pixmap);
  gdk_gc_set_foreground (gc,c);
  return (gc);
}

GdkColor *new_color (long red, long green, long blue)
{
  GdkColor *c = (GdkColor *) g_malloc (sizeof(GdkColor));

  c->red=red;
  c->green=green;
  c->blue=blue;

  gdk_color_alloc (gdk_colormap_get_system(),c);

  return(c);
}



int create_pixmap_from_double (GtkWidget *widget,GdkPixmap *pixmap,double *matriz, int ancho, int alto)
{
  int i,j;
  int indice;
  GdkColor color;
  double zrange;

  GdkGC *penblue = NULL;
  GdkGC *penred = NULL;
  
  GdkGC **palette;

  int palette_elev[256*3]={
    13005,14138,14905,15670,16430,17187,17941,18690,19435,20176,20913,21645,22373,23096,23814,24526,25234,25936,26633,27324,28010,28689,29363,30031,30693,31348,31997,32639,33275,33904,34526,35142,35750,36351,36945,37532,38112,38684,39249,39806,40355,40897,41431,41957,42475,42985,43487,43981,44467,44945,45414,45875,46328,46772,47208,47636,48054,48465,48867,49260,49644,50020,50388,50746,51096,51437,51770,52093,52408,52714,53012,53301,53581,53852,54114,54368,54613,54850,55078,55297,55507,55709,55902,56087,56263,56431,56591,56742,56884,57018,57145,57262,57372,57474,57567,57653,57730,57800,57862,57917,57963,58002,58034,58058,58075,58084,58087,58082,58070,58052,58026,57994,57956,57911,57859,57801,57737,57667,57591,57509,57422,57329,57230,57126,57017,56903,56784,56660,56532,56399,56262,56120,55975,55825,55672,55515,55355,55191,55024,54855,54682,54507,54330,54150,53968,53784,53599,53412,53224,53034,52844,52653,52461,52269,52077,51885,51693,51502,51311,51121,50932,50745,50559,50375,50193,50014,49836,49662,49490,49322,49157,48996,48838,48685,48536,48392,48253,48119,47991,47868,47751,47641,47537,47440,47349,47267,47192,47125,47066,47015,46973,46941,46918,46904,46901,46907,46925,46953,46992,47043,47106,47181,47269,47369,47482,47609,47750,47904,48073,48257,48456,48671,48901,49148,49411,49690,49987,50302,50635,50985,51355,51743,52151,52579,53027,53495,53984,54495,55027,55581,56158,56757,57380,58026,58696,59391,60110,60855,61625,62422,63245,64094,64971,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,
    43241,43422,43585,43751,43920,44092,44266,44442,44621,44802,44984,45169,45354,45541,45729,45918,46108,46298,46488,46679,46870,47061,47252,47442,47632,47821,48010,48197,48384,48569,48752,48935,49115,49294,49471,49646,49819,49990,50159,50325,50488,50649,50807,50962,51114,51263,51409,51551,51691,51826,51959,52087,52213,52334,52451,52565,52675,52780,52882,52979,53072,53161,53245,53326,53401,53473,53539,53602,53659,53712,53760,53804,53843,53877,53906,53931,53950,53965,53975,53980,53981,53976,53967,53952,53933,53909,53880,53846,53808,53764,53716,53663,53605,53542,53475,53403,53326,53245,53159,53068,52973,52873,52770,52661,52549,52432,52310,52185,52056,51922,51785,51644,51498,51349,51197,51041,50881,50718,50552,50382,50209,50033,49854,49672,49488,49300,49111,48918,48724,48527,48328,48127,47924,47720,47514,47306,47097,46887,46675,46463,46250,46036,45822,45607,45392,45177,44963,44748,44534,44320,44107,43895,43685,43475,43267,43060,42856,42653,42452,42254,42058,41865,41675,41489,41305,41125,40949,40777,40609,40445,40286,40132,39982,39838,39700,39567,39441,39320,39206,39098,38998,38904,38818,38740,38670,38607,38554,38508,38472,38445,38428,38420,38422,38434,38457,38491,38536,38593,38661,38741,38833,38938,39056,39187,39331,39489,39662,39848,40050,40266,40498,40745,41009,41288,41585,41898,42228,42577,42943,43327,43730,44152,44594,45055,45536,46037,46560,47103,47668,48255,48863,49495,50149,50827,51528,52254,53004,53779,54579,55404,56256,57134,58039,58971,59931,60918,61935,62980,64054,65025,65025,65025,65025,65025,65025,65025,
    31862,32280,32426,32575,32728,32884,33042,33203,33367,33533,33700,33870,34041,34213,34386,34560,34735,34911,35087,35263,35439,35615,35790,35965,36139,36313,36485,36656,36826,36994,37160,37325,37487,37648,37806,37961,38115,38265,38413,38558,38699,38838,38973,39105,39233,39357,39478,39595,39708,39817,39922,40023,40119,40211,40299,40382,40460,40534,40603,40667,40726,40780,40829,40873,40912,40946,40975,40998,41016,41029,41036,41038,41035,41026,41011,40992,40966,40935,40899,40857,40810,40757,40698,40634,40565,40490,40410,40324,40233,40136,40034,39926,39814,39695,39572,39444,39310,39171,39028,38879,38725,38566,38403,38235,38062,37885,37703,37516,37325,37130,36931,36728,36520,36309,36094,35875,35653,35427,35197,34965,34729,34490,34249,34004,33757,33508,33256,33002,32745,32487,32227,31965,31702,31438,31172,30905,30638,30370,30101,29832,29563,29294,29025,28756,28488,28221,27955,27690,27426,27164,26904,26646,26390,26137,25886,25638,25393,25152,24914,24680,24450,24224,24003,23787,23575,23369,23169,22974,22786,22604,22428,22260,22098,21944,21798,21659,21529,21408,21295,21192,21098,21014,20940,20876,20823,20781,20751,20732,20725,20730,20748,20779,20823,20881,20953,21039,21140,21256,21387,21534,21697,21877,22074,22287,22518,22768,23035,23321,23627,23951,24296,24661,25046,25453,25881,26331,26803,27298,27816,28357,28923,29512,30127,30767,31432,32124,32842,33587,34359,35159,35988,36845,37731,38647,39594,40571,41579,42618,43690,44794,45931,47101,48306,49544,50818,52127,53472,54854,56272,57728,59222,60754,62326,63936,65025,65025
  };

  penblue = get_pen (widget->window, new_color (5120, 5120, 51200));
  penred = get_pen (widget->window, new_color (51200, 5120, 5120));
  
  palette = (GdkGC **)g_malloc(sizeof(GdkGC *)*256);

  create_palete(widget, palette, PALETTENUMBER);

  /*
  for(i=0;i<256;i++)
  {
    palette[i]= get_pen (widget->window, new_color (palette_elev[256*0+i], palette_elev[256*1+i], palette_elev[256*2+i]));
  }
  */
  //printf("%d %d\n",widget->allocation.width,widget->allocation.height);
  gdk_draw_rectangle (pixmap,
                      widget->style->white_gc,
                      TRUE,
                      0, 0,
                      widget->allocation.width,
                      widget->allocation.height);

  zrange=c_var.mapsvector[c_var.actualmap].zmax-c_var.mapsvector[c_var.actualmap].zmin;

  for (j=0;j<alto;j++)
   {
     for (i=0;i<ancho;i++)
     {
       if(matriz[j*ancho+i]==c_var.mapsvector[c_var.actualmap].open_boundary)
       {
         gdk_draw_rectangle (pixmap,
                      penblue,
                      TRUE,
                      (int)(0.5+i*widget->allocation.width/ancho), (int)(0.5+j*widget->allocation.height/alto),
                      (int)(widget->allocation.width/ancho)+1,
                      (int)(widget->allocation.height/alto)+1);
         
       }
       else if(matriz[j*ancho+i]==c_var.mapsvector[c_var.actualmap].land_boundary)
       {
         gdk_draw_rectangle (pixmap,
                      penred,
                      TRUE,
                      (int)(0.5+i*widget->allocation.width/ancho), (int)(0.5+j*widget->allocation.height/alto),
                      (int)(widget->allocation.width/ancho)+1,
                      (int)(widget->allocation.height/alto)+1);
       }
       else
       {
         indice= (int)(254*(matriz[j*ancho+i]-c_var.mapsvector[c_var.actualmap].zmin)/zrange);
         if(indice<0){indice=0;}
         if(indice>255){indice=255;}
         gdk_draw_rectangle (pixmap,
                      palette[indice],
                      TRUE,
                      (int)(0.5+i*widget->allocation.width/ancho), (int)(0.5+j*widget->allocation.height/alto),
                      (int)(widget->allocation.width/ancho)+1, 
                      (int)(widget->allocation.height/alto)+1);
       }
     }
   }
  return TRUE;
}

void draw_brush( GtkWidget *widget, GdkDrawable *drawable, int type, gdouble x, gdouble y)
{
  GdkRectangle update_rect;
  GdkGC *penblue = NULL;

  //printf("draw brush: coordenadas %d %d\n",(int)x,(int)y);

  if(type==0)
  {
    update_rect.x = x - 2;
    update_rect.y = y-2;
    update_rect.width = 4;
    update_rect.height = 4;

    penblue = get_pen (widget->window, new_color (5120, 5120, 51200));
    
    gdk_draw_line (drawable,
                   penblue,
                   x-2, y-2,
                   x+2, y+2);
    gdk_draw_line (drawable,
                   penblue,
                   x+2, y-2,
                   x-2, y+2);
  }
 
  if(type==1)
  {
    update_rect.x = x - 1;
    update_rect.y = 0;
    update_rect.width = 3;
    update_rect.height = widget->allocation.height;

    gdk_draw_line (drawable,
                   widget->style->black_gc,
                   x, 0,
                   x, widget->allocation.height);
  }
  if(type==2)
  {
    update_rect.y = y - 1;
    update_rect.x = 0;
    update_rect.height = 3;
    update_rect.width = widget->allocation.width;

    gdk_draw_line (drawable,
                   widget->style->black_gc,
                   0, y,
                   widget->allocation.width, y);
  }  
  gtk_widget_draw (widget, &update_rect);
}



int create_pixmap_from_double_irregular (GtkWidget *widget,GdkPixmap *pixmap,double *matriz, double *horizontal_width, double *vertical_width, int ancho, int alto)
{
  int i,j;
  int indice;
  int xbegin,ybegin,boxwidth,boxheight;
  int pixel_hor,pixel_ver;
  double add_alto, add_ancho;
  GdkColor color;
  double zrange;
  double zmin,zmax;

  GdkGC *penblue = NULL;
  GdkGC *penred = NULL;

  GdkGC **palette;

  int palette_elev[256*3]={
    13005,14138,14905,15670,16430,17187,17941,18690,19435,20176,20913,21645,22373,23096,23814,24526,25234,25936,26633,27324,28010,28689,29363,30031,30693,31348,31997,32639,33275,33904,34526,35142,35750,36351,36945,37532,38112,38684,39249,39806,40355,40897,41431,41957,42475,42985,43487,43981,44467,44945,45414,45875,46328,46772,47208,47636,48054,48465,48867,49260,49644,50020,50388,50746,51096,51437,51770,52093,52408,52714,53012,53301,53581,53852,54114,54368,54613,54850,55078,55297,55507,55709,55902,56087,56263,56431,56591,56742,56884,57018,57145,57262,57372,57474,57567,57653,57730,57800,57862,57917,57963,58002,58034,58058,58075,58084,58087,58082,58070,58052,58026,57994,57956,57911,57859,57801,57737,57667,57591,57509,57422,57329,57230,57126,57017,56903,56784,56660,56532,56399,56262,56120,55975,55825,55672,55515,55355,55191,55024,54855,54682,54507,54330,54150,53968,53784,53599,53412,53224,53034,52844,52653,52461,52269,52077,51885,51693,51502,51311,51121,50932,50745,50559,50375,50193,50014,49836,49662,49490,49322,49157,48996,48838,48685,48536,48392,48253,48119,47991,47868,47751,47641,47537,47440,47349,47267,47192,47125,47066,47015,46973,46941,46918,46904,46901,46907,46925,46953,46992,47043,47106,47181,47269,47369,47482,47609,47750,47904,48073,48257,48456,48671,48901,49148,49411,49690,49987,50302,50635,50985,51355,51743,52151,52579,53027,53495,53984,54495,55027,55581,56158,56757,57380,58026,58696,59391,60110,60855,61625,62422,63245,64094,64971,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,
    43241,43422,43585,43751,43920,44092,44266,44442,44621,44802,44984,45169,45354,45541,45729,45918,46108,46298,46488,46679,46870,47061,47252,47442,47632,47821,48010,48197,48384,48569,48752,48935,49115,49294,49471,49646,49819,49990,50159,50325,50488,50649,50807,50962,51114,51263,51409,51551,51691,51826,51959,52087,52213,52334,52451,52565,52675,52780,52882,52979,53072,53161,53245,53326,53401,53473,53539,53602,53659,53712,53760,53804,53843,53877,53906,53931,53950,53965,53975,53980,53981,53976,53967,53952,53933,53909,53880,53846,53808,53764,53716,53663,53605,53542,53475,53403,53326,53245,53159,53068,52973,52873,52770,52661,52549,52432,52310,52185,52056,51922,51785,51644,51498,51349,51197,51041,50881,50718,50552,50382,50209,50033,49854,49672,49488,49300,49111,48918,48724,48527,48328,48127,47924,47720,47514,47306,47097,46887,46675,46463,46250,46036,45822,45607,45392,45177,44963,44748,44534,44320,44107,43895,43685,43475,43267,43060,42856,42653,42452,42254,42058,41865,41675,41489,41305,41125,40949,40777,40609,40445,40286,40132,39982,39838,39700,39567,39441,39320,39206,39098,38998,38904,38818,38740,38670,38607,38554,38508,38472,38445,38428,38420,38422,38434,38457,38491,38536,38593,38661,38741,38833,38938,39056,39187,39331,39489,39662,39848,40050,40266,40498,40745,41009,41288,41585,41898,42228,42577,42943,43327,43730,44152,44594,45055,45536,46037,46560,47103,47668,48255,48863,49495,50149,50827,51528,52254,53004,53779,54579,55404,56256,57134,58039,58971,59931,60918,61935,62980,64054,65025,65025,65025,65025,65025,65025,65025,
    31862,32280,32426,32575,32728,32884,33042,33203,33367,33533,33700,33870,34041,34213,34386,34560,34735,34911,35087,35263,35439,35615,35790,35965,36139,36313,36485,36656,36826,36994,37160,37325,37487,37648,37806,37961,38115,38265,38413,38558,38699,38838,38973,39105,39233,39357,39478,39595,39708,39817,39922,40023,40119,40211,40299,40382,40460,40534,40603,40667,40726,40780,40829,40873,40912,40946,40975,40998,41016,41029,41036,41038,41035,41026,41011,40992,40966,40935,40899,40857,40810,40757,40698,40634,40565,40490,40410,40324,40233,40136,40034,39926,39814,39695,39572,39444,39310,39171,39028,38879,38725,38566,38403,38235,38062,37885,37703,37516,37325,37130,36931,36728,36520,36309,36094,35875,35653,35427,35197,34965,34729,34490,34249,34004,33757,33508,33256,33002,32745,32487,32227,31965,31702,31438,31172,30905,30638,30370,30101,29832,29563,29294,29025,28756,28488,28221,27955,27690,27426,27164,26904,26646,26390,26137,25886,25638,25393,25152,24914,24680,24450,24224,24003,23787,23575,23369,23169,22974,22786,22604,22428,22260,22098,21944,21798,21659,21529,21408,21295,21192,21098,21014,20940,20876,20823,20781,20751,20732,20725,20730,20748,20779,20823,20881,20953,21039,21140,21256,21387,21534,21697,21877,22074,22287,22518,22768,23035,23321,23627,23951,24296,24661,25046,25453,25881,26331,26803,27298,27816,28357,28923,29512,30127,30767,31432,32124,32842,33587,34359,35159,35988,36845,37731,38647,39594,40571,41579,42618,43690,44794,45931,47101,48306,49544,50818,52127,53472,54854,56272,57728,59222,60754,62326,63936,65025,65025
  };

  penblue = get_pen (widget->window, new_color (5120, 5120, 51200));
  penred = get_pen (widget->window, new_color (51200, 5120, 5120));

  palette = (GdkGC **)g_malloc(sizeof(GdkGC *)*256);

  create_palete(widget, palette, PALETTENUMBER);
  /*
  for(i=0;i<256;i++)
  {
    palette[i]= get_pen (widget->window, new_color (palette_elev[256*0+i], palette_elev[256*1+i], palette_elev[256*2+i]));
  }
  */

  //printf("%d %d\n",widget->allocation.width,widget->allocation.height);
  gdk_draw_rectangle (pixmap,
                      widget->style->white_gc,
                      TRUE,
                      0, 0,
                      widget->allocation.width,
                      widget->allocation.height);


  zmin= matriz[0];
  zmax=zmin;
  for (j=0;j<alto;j++)
  {
    for (i=0;i<ancho;i++)
    {
      if(zmin>matriz[j*ancho+i])
      {zmin=matriz[j*ancho+i];}
      if(zmax<matriz[j*ancho+i])
      {zmax=matriz[j*ancho+i];}

    }
  }

  //zmax=c_var.mapsvector[c_var.actualmap].zmax;
  //zmin=c_var.mapsvector[c_var.actualmap].zmin;
  
  zrange=zmax-zmin;
  
  add_ancho=0;
  add_alto=0;
  for (j=0;j<alto;j++)
   {
     add_alto+= vertical_width[j];
   }
  for (j=0;j<ancho;j++)
   {
     add_ancho+= horizontal_width[j];
   }

  //printf("add, ancho alto: %f %f\n",add_ancho,add_alto);

  
  pixel_ver=0;
  ybegin=0;
  boxheight=0;
  for (j=0;j<alto;j++)
   {
     //printf("\n%f ",vertical_width[j]);
     //pixel_hor=0;
     ybegin+=boxheight;
     boxheight=(int)(widget->allocation.height*vertical_width[j]/add_alto);
     //printf("verticalwidth, addalto: %f %f\n",vertical_width[j],add_alto);
     //printf("pixeles verticales: %d %d\n",widget->allocation.height,ybegin);
     xbegin=0;
     boxwidth=0;
     for (i=0;i<ancho;i++)
     {
       //printf("%f ",horizontal_width[i]);
       
       //xbegin=(int)(0.5+i*widget->allocation.width/ancho);
       xbegin+=boxwidth;
       boxwidth=(int)(widget->allocation.width*horizontal_width[i]/add_ancho);
       //printf("pixeles: %d %d\n",widget->allocation.width,xbegin);

       //ybegin=(int)(0.5+j*widget->allocation.height/alto);
       //boxwidth=(int)(widget->allocation.width/ancho)+1;
       //boxheight=(int)(widget->allocation.height/alto)+1;
       if(matriz[j*ancho+i]==c_var.mapsvector[c_var.actualmap].open_boundary)
       {
         gdk_draw_rectangle (pixmap,
                      penblue,
                      TRUE,
                      xbegin, ybegin,
                      boxwidth,boxheight);

       }
       else if(matriz[j*ancho+i]==c_var.mapsvector[c_var.actualmap].land_boundary)
       {
         gdk_draw_rectangle (pixmap,
                      penred,
                      TRUE,
                      xbegin, ybegin,
                      boxwidth,boxheight);
       }
       else
       {
         indice= (int)(254*(matriz[j*ancho+i]-zmin)/zrange);
         if(indice<0){indice=0;}
         if(indice>255){indice=255;}
         gdk_draw_rectangle (pixmap,
                      palette[indice],
                      TRUE,
                      xbegin, ybegin,
                      boxwidth,boxheight);
       }
     }
   }
   //printf("\n");
  return TRUE;
}


int create_palete(GtkWidget *widget, GdkGC **palette,int number)
{
  //GdkGC **palette;
  int i;

  if(number ==1)
  {
    int palette_elev[256*3]={
      13005,14138,14905,15670,16430,17187,17941,18690,19435,20176,20913,21645,22373,23096,23814,24526,25234,25936,26633,27324,28010,28689,29363,30031,30693,31348,31997,32639,33275,33904,34526,35142,35750,36351,36945,37532,38112,38684,39249,39806,40355,40897,41431,41957,42475,42985,43487,43981,44467,44945,45414,45875,46328,46772,47208,47636,48054,48465,48867,49260,49644,50020,50388,50746,51096,51437,51770,52093,52408,52714,53012,53301,53581,53852,54114,54368,54613,54850,55078,55297,55507,55709,55902,56087,56263,56431,56591,56742,56884,57018,57145,57262,57372,57474,57567,57653,57730,57800,57862,57917,57963,58002,58034,58058,58075,58084,58087,58082,58070,58052,58026,57994,57956,57911,57859,57801,57737,57667,57591,57509,57422,57329,57230,57126,57017,56903,56784,56660,56532,56399,56262,56120,55975,55825,55672,55515,55355,55191,55024,54855,54682,54507,54330,54150,53968,53784,53599,53412,53224,53034,52844,52653,52461,52269,52077,51885,51693,51502,51311,51121,50932,50745,50559,50375,50193,50014,49836,49662,49490,49322,49157,48996,48838,48685,48536,48392,48253,48119,47991,47868,47751,47641,47537,47440,47349,47267,47192,47125,47066,47015,46973,46941,46918,46904,46901,46907,46925,46953,46992,47043,47106,47181,47269,47369,47482,47609,47750,47904,48073,48257,48456,48671,48901,49148,49411,49690,49987,50302,50635,50985,51355,51743,52151,52579,53027,53495,53984,54495,55027,55581,56158,56757,57380,58026,58696,59391,60110,60855,61625,62422,63245,64094,64971,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,65025,
      43241,43422,43585,43751,43920,44092,44266,44442,44621,44802,44984,45169,45354,45541,45729,45918,46108,46298,46488,46679,46870,47061,47252,47442,47632,47821,48010,48197,48384,48569,48752,48935,49115,49294,49471,49646,49819,49990,50159,50325,50488,50649,50807,50962,51114,51263,51409,51551,51691,51826,51959,52087,52213,52334,52451,52565,52675,52780,52882,52979,53072,53161,53245,53326,53401,53473,53539,53602,53659,53712,53760,53804,53843,53877,53906,53931,53950,53965,53975,53980,53981,53976,53967,53952,53933,53909,53880,53846,53808,53764,53716,53663,53605,53542,53475,53403,53326,53245,53159,53068,52973,52873,52770,52661,52549,52432,52310,52185,52056,51922,51785,51644,51498,51349,51197,51041,50881,50718,50552,50382,50209,50033,49854,49672,49488,49300,49111,48918,48724,48527,48328,48127,47924,47720,47514,47306,47097,46887,46675,46463,46250,46036,45822,45607,45392,45177,44963,44748,44534,44320,44107,43895,43685,43475,43267,43060,42856,42653,42452,42254,42058,41865,41675,41489,41305,41125,40949,40777,40609,40445,40286,40132,39982,39838,39700,39567,39441,39320,39206,39098,38998,38904,38818,38740,38670,38607,38554,38508,38472,38445,38428,38420,38422,38434,38457,38491,38536,38593,38661,38741,38833,38938,39056,39187,39331,39489,39662,39848,40050,40266,40498,40745,41009,41288,41585,41898,42228,42577,42943,43327,43730,44152,44594,45055,45536,46037,46560,47103,47668,48255,48863,49495,50149,50827,51528,52254,53004,53779,54579,55404,56256,57134,58039,58971,59931,60918,61935,62980,64054,65025,65025,65025,65025,65025,65025,65025,
      31862,32280,32426,32575,32728,32884,33042,33203,33367,33533,33700,33870,34041,34213,34386,34560,34735,34911,35087,35263,35439,35615,35790,35965,36139,36313,36485,36656,36826,36994,37160,37325,37487,37648,37806,37961,38115,38265,38413,38558,38699,38838,38973,39105,39233,39357,39478,39595,39708,39817,39922,40023,40119,40211,40299,40382,40460,40534,40603,40667,40726,40780,40829,40873,40912,40946,40975,40998,41016,41029,41036,41038,41035,41026,41011,40992,40966,40935,40899,40857,40810,40757,40698,40634,40565,40490,40410,40324,40233,40136,40034,39926,39814,39695,39572,39444,39310,39171,39028,38879,38725,38566,38403,38235,38062,37885,37703,37516,37325,37130,36931,36728,36520,36309,36094,35875,35653,35427,35197,34965,34729,34490,34249,34004,33757,33508,33256,33002,32745,32487,32227,31965,31702,31438,31172,30905,30638,30370,30101,29832,29563,29294,29025,28756,28488,28221,27955,27690,27426,27164,26904,26646,26390,26137,25886,25638,25393,25152,24914,24680,24450,24224,24003,23787,23575,23369,23169,22974,22786,22604,22428,22260,22098,21944,21798,21659,21529,21408,21295,21192,21098,21014,20940,20876,20823,20781,20751,20732,20725,20730,20748,20779,20823,20881,20953,21039,21140,21256,21387,21534,21697,21877,22074,22287,22518,22768,23035,23321,23627,23951,24296,24661,25046,25453,25881,26331,26803,27298,27816,28357,28923,29512,30127,30767,31432,32124,32842,33587,34359,35159,35988,36845,37731,38647,39594,40571,41579,42618,43690,44794,45931,47101,48306,49544,50818,52127,53472,54854,56272,57728,59222,60754,62326,63936,65025,65025
    };

  //palette = (GdkGC **)g_malloc(sizeof(GdkGC *)*256);

    for(i=0;i<256;i++)
    {
      //printf("creando paleta colores en funcion\n");
      palette[i]= get_pen (widget->window, new_color (palette_elev[256*0+i], palette_elev[256*1+i], palette_elev[256*2+i]));
    }
  }

  if(number == 2)
  {

    for(i=0;i<256;i++)
    {
      //printf("creando paleta colores en funcion\n");
      palette[i]= get_pen (widget->window, new_color (256*i, 21845, 256*(255-i)));
    }
  }
  if(number == 3)
  {

    for(i=0;i<256;i++)
    {
      //printf("creando paleta colores en funcion\n");
      palette[i]= get_pen (widget->window, new_color (256*i, 256*i, 256*255));
    }
  }

  if(number == 4)
  {

    for(i=0;i<256;i++)
    {
      //printf("creando paleta colores en funcion\n");
      palette[i]= get_pen (widget->window, new_color (256*i, 256*i, 256*i));
    }
  }
  //return(palette);
  
}



        